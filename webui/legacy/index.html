<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG-Anything Web UI æ¼”ç¤º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap');
        
        /* å¼ºåˆ¶ä½¿ç”¨ä¸­æ–‡å­—ä½“ */
        * {
            font-family: "Noto Sans SC", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", "SimSun", sans-serif !important;
        }
        
        /* ç¡®ä¿ä¸­æ–‡å­—ç¬¦æ­£ç¡®æ˜¾ç¤º */
        body, html {
            font-family: "Noto Sans SC", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", "SimSun", sans-serif !important;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* ç‰¹åˆ«å¤„ç†ä¸­æ–‡æ–‡æœ¬ */
        .chinese-text {
            font-family: "Noto Sans SC", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", "SimSun", sans-serif !important;
            font-weight: 400;
        }
        
        /* è‡ªå®šä¹‰åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900">
    <div class="min-h-screen flex">
        <!-- ä¾§è¾¹æ  -->
        <div class="w-64 bg-white dark:bg-gray-800 shadow-lg">
            <div class="p-6">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold">R</span>
                    </div>
                    <h1 class="text-xl font-bold text-gray-900 dark:text-white">RAG-Anything</h1>
                </div>
            </div>
            
            <nav class="mt-6">
                <div class="px-4 space-y-2">
                    <button onclick="showSection('overview')" class="nav-btn w-full text-left px-4 py-2 rounded-lg flex items-center space-x-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700">
                        <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                        <span>æ¦‚è§ˆ</span>
                    </button>
                    <button onclick="showSection('upload')" class="nav-btn w-full text-left px-4 py-2 rounded-lg flex items-center space-x-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700">
                        <i data-lucide="upload" class="w-5 h-5"></i>
                        <span>æ–‡æ¡£ç®¡ç†</span>
                    </button>
                    <button onclick="showSection('query')" class="nav-btn w-full text-left px-4 py-2 rounded-lg flex items-center space-x-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700">
                        <i data-lucide="message-square" class="w-5 h-5"></i>
                        <span>æ™ºèƒ½æŸ¥è¯¢</span>
                    </button>
                    <button onclick="showSection('status')" class="nav-btn w-full text-left px-4 py-2 rounded-lg flex items-center space-x-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700">
                        <i data-lucide="bar-chart-3" class="w-5 h-5"></i>
                        <span>ç³»ç»ŸçŠ¶æ€</span>
                    </button>
                    <button onclick="showSection('config')" class="nav-btn w-full text-left px-4 py-2 rounded-lg flex items-center space-x-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700">
                        <i data-lucide="settings" class="w-5 h-5"></i>
                        <span>é…ç½®</span>
                    </button>
                </div>
            </nav>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="flex-1 p-8 overflow-auto">
            <!-- æ¦‚è§ˆé¡µé¢ -->
            <div id="overview" class="section">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900 dark:text-white">RAG-Anything ä»ªè¡¨ç›˜</h2>
                    <p class="text-gray-600 dark:text-gray-300 mt-2">å¤šæ¨¡æ€æ£€ç´¢å¢å¼ºç”Ÿæˆç³»ç»Ÿæ§åˆ¶ä¸­å¿ƒ</p>
                </div>

                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                        <div class="flex items-center">
                            <i data-lucide="file-text" class="w-8 h-8 text-blue-600"></i>
                            <div class="ml-4">
                                <p class="text-blue-600 text-sm font-medium">å·²å¤„ç†æ–‡æ¡£</p>
                                <p class="text-2xl font-bold text-blue-900" id="doc-count">24</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                        <div class="flex items-center">
                            <i data-lucide="message-square" class="w-8 h-8 text-green-600"></i>
                            <div class="ml-4">
                                <p class="text-green-600 text-sm font-medium">æŸ¥è¯¢æ¬¡æ•°</p>
                                <p class="text-2xl font-bold text-green-900" id="query-count">156</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-purple-50 p-6 rounded-lg border border-purple-200">
                        <div class="flex items-center">
                            <i data-lucide="database" class="w-8 h-8 text-purple-600"></i>
                            <div class="ml-4">
                                <p class="text-purple-600 text-sm font-medium">çŸ¥è¯†å—</p>
                                <p class="text-2xl font-bold text-purple-900">1,247</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-orange-50 p-6 rounded-lg border border-orange-200">
                        <div class="flex items-center">
                            <i data-lucide="bar-chart-3" class="w-8 h-8 text-orange-600"></i>
                            <div class="ml-4">
                                <p class="text-orange-600 text-sm font-medium">ç³»ç»ŸçŠ¶æ€</p>
                                <p class="text-lg font-bold text-orange-900" id="system-status">æ­£å¸¸</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¿«é€Ÿæ“ä½œ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg border">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">å¿«é€Ÿæ“ä½œ</h3>
                        <div class="space-y-3">
                            <button onclick="showSection('upload')" class="w-full text-left p-3 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                                <div class="flex items-center">
                                    <i data-lucide="upload" class="w-5 h-5 text-blue-600 mr-3"></i>
                                    <span class="text-blue-900">ä¸Šä¼ æ–°æ–‡æ¡£</span>
                                </div>
                            </button>
                            <button onclick="showSection('query')" class="w-full text-left p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
                                <div class="flex items-center">
                                    <i data-lucide="message-square" class="w-5 h-5 text-green-600 mr-3"></i>
                                    <span class="text-green-900">å¼€å§‹æŸ¥è¯¢</span>
                                </div>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg border">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">æœ€è¿‘æ´»åŠ¨</h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center text-gray-600">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <span>æ–‡æ¡£ "research_paper.pdf" å¤„ç†å®Œæˆ</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                <span>æ‰§è¡Œäº†æŸ¥è¯¢: "æœºå™¨å­¦ä¹ çš„åº”ç”¨åœºæ™¯"</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <div class="w-2 h-2 bg-purple-500 rounded-full mr-3"></div>
                                <span>æ›´æ–°äº†ç³»ç»Ÿé…ç½®</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æŸ¥è¯¢é¡µé¢ -->
            <div id="query" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900">æ™ºèƒ½æŸ¥è¯¢</h2>
                    <p class="text-gray-600 mt-2">åŸºäºå¤šæ¨¡æ€RAGç³»ç»Ÿçš„æ™ºèƒ½é—®ç­”</p>
                </div>

                <!-- æŸ¥è¯¢æ¨¡å¼é€‰æ‹© -->
                <div class="bg-white p-4 rounded-lg border mb-6">
                    <h3 class="text-sm font-medium text-gray-900 mb-3">æŸ¥è¯¢æ¨¡å¼</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                        <button onclick="setQueryMode('local')" class="query-mode-btn p-2 text-sm rounded-lg border bg-gray-50 text-gray-600 hover:bg-gray-100" data-mode="local">æœ¬åœ°æŸ¥è¯¢</button>
                        <button onclick="setQueryMode('global')" class="query-mode-btn p-2 text-sm rounded-lg border bg-gray-50 text-gray-600 hover:bg-gray-100" data-mode="global">å…¨å±€æŸ¥è¯¢</button>
                        <button onclick="setQueryMode('hybrid')" class="query-mode-btn p-2 text-sm rounded-lg border bg-blue-50 border-blue-300 text-blue-700" data-mode="hybrid">æ··åˆæŸ¥è¯¢</button>
                        <button onclick="setQueryMode('naive')" class="query-mode-btn p-2 text-sm rounded-lg border bg-gray-50 text-gray-600 hover:bg-gray-100" data-mode="naive">ç®€å•æŸ¥è¯¢</button>
                    </div>
                </div>

                <!-- æŸ¥è¯¢è¾“å…¥ -->
                <div class="bg-white p-6 rounded-lg border mb-6">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-900 mb-2">è¾“å…¥æ‚¨çš„é—®é¢˜</label>
                            <textarea id="query-input" class="w-full p-3 border rounded-lg resize-none" rows="4" placeholder="ä¾‹å¦‚ï¼šè¯·åˆ†æè¿™ä¸ªè¡¨æ ¼ä¸­çš„æ•°æ®è¶‹åŠ¿..."></textarea>
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <button class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg" title="æ·»åŠ å›¾ç‰‡">
                                    <i data-lucide="image" class="w-5 h-5"></i>
                                </button>
                                <button class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg" title="æ·»åŠ è¡¨æ ¼">
                                    <i data-lucide="table" class="w-5 h-5"></i>
                                </button>
                                <button class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg" title="æ·»åŠ å…¬å¼">
                                    <i data-lucide="calculator" class="w-5 h-5"></i>
                                </button>
                            </div>

                            <button onclick="executeQuery()" id="query-btn" class="flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                                <i data-lucide="send" class="w-4 h-4"></i>
                                <span>å‘é€æŸ¥è¯¢</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- æŸ¥è¯¢ç»“æœ -->
                <div id="query-results" class="space-y-4">
                    <!-- ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>

            <!-- ç³»ç»ŸçŠ¶æ€é¡µé¢ -->
            <div id="status" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900">ç³»ç»ŸçŠ¶æ€</h2>
                    <p class="text-gray-600 mt-2">ç›‘æ§RAGç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡</p>
                </div>

                <!-- ç³»ç»ŸæŒ‡æ ‡ -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg border">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="cpu" class="w-5 h-5 text-blue-600"></i>
                                <span class="text-sm font-medium text-gray-900">CPUä½¿ç”¨ç‡</span>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">æ­£å¸¸</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="cpu-usage">45.2%</div>
                    </div>

                    <div class="bg-white p-6 rounded-lg border">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="hard-drive" class="w-5 h-5 text-green-600"></i>
                                <span class="text-sm font-medium text-gray-900">å†…å­˜ä½¿ç”¨ç‡</span>
                            </div>
                            <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full">è­¦å‘Š</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="memory-usage">68.1%</div>
                    </div>

                    <div class="bg-white p-6 rounded-lg border">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="database" class="w-5 h-5 text-purple-600"></i>
                                <span class="text-sm font-medium text-gray-900">ç£ç›˜ä½¿ç”¨ç‡</span>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">æ­£å¸¸</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900">32.4%</div>
                    </div>

                    <div class="bg-white p-6 rounded-lg border">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="zap" class="w-5 h-5 text-orange-600"></i>
                                <span class="text-sm font-medium text-gray-900">GPUä½¿ç”¨ç‡</span>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">æ­£å¸¸</span>
                        </div>
                        <div class="text-2xl font-bold text-gray-900" id="gpu-usage">78.3%</div>
                    </div>
                </div>

                <!-- æœåŠ¡çŠ¶æ€ -->
                <div class="bg-white p-6 rounded-lg border">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">æœåŠ¡çŠ¶æ€</h3>
                    <div id="service-status" class="space-y-4">
                        <!-- æœåŠ¡çŠ¶æ€å°†é€šè¿‡APIåŠ è½½ -->
                    </div>
                </div>
            </div>

            <!-- æ–‡æ¡£ä¸Šä¼ é¡µé¢ -->
            <div id="upload" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900">æ–‡æ¡£ç®¡ç†</h2>
                    <p class="text-gray-600 mt-2">ä¸Šä¼ å¹¶å¤„ç†å„ç§æ ¼å¼çš„æ–‡æ¡£</p>
                </div>

                <!-- ä¸Šä¼ åŒºåŸŸ -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-8 hover:border-blue-400 hover:bg-blue-50 transition-all">
                    <i data-lucide="upload" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»ä¸Šä¼ </h3>
                    <p class="text-gray-600 mb-4">æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼ŒåŒ…æ‹¬ PDFã€Wordã€PowerPointã€å›¾ç‰‡ç­‰</p>
                    <input type="file" multiple id="file-input" class="hidden" accept=".pdf,.doc,.docx,.ppt,.pptx,.txt,.md,.jpg,.jpeg,.png,.gif,.bmp,.tiff,.webp">
                    <button onclick="document.getElementById('file-input').click()" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                        é€‰æ‹©æ–‡ä»¶
                    </button>
                </div>

                <!-- æ”¯æŒæ ¼å¼ -->
                <div class="bg-white p-6 rounded-lg border mb-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">æ”¯æŒçš„æ–‡ä»¶æ ¼å¼</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ“„</div>
                            <div class="text-xs font-medium">.pdf</div>
                            <div class="text-xs text-gray-600">PDFæ–‡æ¡£</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ“</div>
                            <div class="text-xs font-medium">.docx</div>
                            <div class="text-xs text-gray-600">Wordæ–‡æ¡£</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ“Š</div>
                            <div class="text-xs font-medium">.pptx</div>
                            <div class="text-xs text-gray-600">PowerPointæ¼”ç¤º</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ“‹</div>
                            <div class="text-xs font-medium">.txt</div>
                            <div class="text-xs text-gray-600">æ–‡æœ¬æ–‡ä»¶</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ“”</div>
                            <div class="text-xs font-medium">.md</div>
                            <div class="text-xs text-gray-600">Markdownæ–‡ä»¶</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ–¼ï¸</div>
                            <div class="text-xs font-medium">.jpg</div>
                            <div class="text-xs text-gray-600">å›¾ç‰‡æ–‡ä»¶</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl mb-2">ğŸ–¼ï¸</div>
                            <div class="text-xs font-medium">.png</div>
                            <div class="text-xs text-gray-600">å›¾ç‰‡æ–‡ä»¶</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é…ç½®é¡µé¢ -->
            <div id="config" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-900">ç³»ç»Ÿé…ç½®</h2>
                    <p class="text-gray-600 mt-2">ç®¡ç†RAGç³»ç»Ÿçš„å„é¡¹é…ç½®å‚æ•°</p>
                </div>

                <div class="bg-white p-6 rounded-lg border">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">è¿æ¥æµ‹è¯•</h3>
                    <button onclick="testConnection()" class="flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        <i data-lucide="wifi" class="w-4 h-4"></i>
                        <span>æµ‹è¯•APIè¿æ¥</span>
                    </button>
                    <div id="connection-result" class="mt-4"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQueryMode = 'hybrid';

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            loadSystemStatus();
            
            // è®¾ç½®é»˜è®¤æ¿€æ´»çš„å¯¼èˆªé¡¹
            showSection('overview');
        });

        // æ˜¾ç¤ºæŒ‡å®šéƒ¨åˆ†
        function showSection(sectionId) {
            // éšè—æ‰€æœ‰section
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // æ˜¾ç¤ºæŒ‡å®šsection
            document.getElementById(sectionId).classList.remove('hidden');
            document.getElementById(sectionId).classList.add('animate-fade-in');
            
            // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-50', 'text-blue-700');
                btn.classList.add('text-gray-700', 'hover:bg-blue-50', 'hover:text-blue-700');
            });
            
            // æ¿€æ´»å½“å‰æŒ‰é’® - ä¿®å¤eventæœªå®šä¹‰çš„é—®é¢˜
            const targetBtn = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (targetBtn) {
                targetBtn.classList.add('bg-blue-50', 'text-blue-700');
                targetBtn.classList.remove('text-gray-700');
            }
        }

        // è®¾ç½®æŸ¥è¯¢æ¨¡å¼
        function setQueryMode(mode) {
            currentQueryMode = mode;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.query-mode-btn').forEach(btn => {
                btn.classList.remove('bg-blue-50', 'border-blue-300', 'text-blue-700');
                btn.classList.add('bg-gray-50', 'text-gray-600');
            });
            
            // æ¿€æ´»é€‰ä¸­çš„æŒ‰é’®
            const selectedBtn = document.querySelector(`[data-mode="${mode}"]`);
            selectedBtn.classList.add('bg-blue-50', 'border-blue-300', 'text-blue-700');
            selectedBtn.classList.remove('bg-gray-50', 'text-gray-600');
        }

        // æ‰§è¡ŒæŸ¥è¯¢
        async function executeQuery() {
            const queryInput = document.getElementById('query-input');
            const queryBtn = document.getElementById('query-btn');
            const resultsContainer = document.getElementById('query-results');
            
            if (!queryInput.value.trim()) {
                alert('è¯·è¾“å…¥æŸ¥è¯¢å†…å®¹');
                return;
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            queryBtn.innerHTML = '<div class="loading"></div><span>æŸ¥è¯¢ä¸­...</span>';
            queryBtn.disabled = true;
            
            try {
                const response = await fetch('http://localhost:8000/api/v1/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: queryInput.value,
                        mode: currentQueryMode
                    })
                });
                
                const result = await response.json();
                
                // æ˜¾ç¤ºç»“æœ
                const resultHtml = `
                    <div class="bg-white p-6 rounded-lg border animate-fade-in">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900 mb-1">${queryInput.value}</h4>
                                <div class="flex items-center space-x-4 text-xs text-gray-500">
                                    <span>${new Date(result.timestamp).toLocaleString()}</span>
                                    <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full">${result.mode}</span>
                                    <span>è€—æ—¶: ${(result.processing_time * 1000).toFixed(1)}ms</span>
                                </div>
                            </div>
                        </div>
                        <div class="text-gray-700 whitespace-pre-wrap">${result.result}</div>
                    </div>
                `;
                
                resultsContainer.insertAdjacentHTML('afterbegin', resultHtml);
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                queryInput.value = '';
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                const queryCount = document.getElementById('query-count');
                queryCount.textContent = parseInt(queryCount.textContent) + 1;
                
            } catch (error) {
                console.error('æŸ¥è¯¢å¤±è´¥:', error);
                alert('æŸ¥è¯¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥APIè¿æ¥');
            }
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            queryBtn.innerHTML = '<i data-lucide="send" class="w-4 h-4"></i><span>å‘é€æŸ¥è¯¢</span>';
            queryBtn.disabled = false;
            lucide.createIcons();
        }

        // åŠ è½½ç³»ç»ŸçŠ¶æ€
        async function loadSystemStatus() {
            try {
                const response = await fetch('http://localhost:8000/api/system/status');
                const data = await response.json();
                
                // æ›´æ–°æŒ‡æ ‡
                document.getElementById('cpu-usage').textContent = data.metrics.cpu_usage + '%';
                document.getElementById('memory-usage').textContent = data.metrics.memory_usage + '%';
                document.getElementById('gpu-usage').textContent = data.metrics.gpu_usage + '%';
                document.getElementById('system-status').textContent = data.status === 'healthy' ? 'æ­£å¸¸' : 'å¼‚å¸¸';
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                document.getElementById('doc-count').textContent = data.processing_stats.documents_processed;
                document.getElementById('query-count').textContent = data.processing_stats.queries_handled;
                
                // æ›´æ–°çŸ¥è¯†å—æ•°æ® - æ˜¾ç¤ºchunksæ•°é‡
                if (data.processing_stats.knowledge_blocks !== undefined) {
                    document.querySelector('.text-purple-900').textContent = data.processing_stats.knowledge_blocks.toLocaleString();
                }
                
                // æ›´æ–°æœåŠ¡çŠ¶æ€
                const serviceStatusContainer = document.getElementById('service-status');
                let servicesHtml = '';
                
                Object.entries(data.services).forEach(([name, service]) => {
                    const statusColor = service.status === 'running' ? 'bg-green-500' : 'bg-red-500';
                    const statusText = service.status === 'running' ? 'è¿è¡Œä¸­' : 'å·²åœæ­¢';
                    
                    servicesHtml += `
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <div class="w-3 h-3 ${statusColor} rounded-full"></div>
                                <span class="font-medium text-gray-900">${name}</span>
                            </div>
                            <div class="text-right">
                                <div class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full">${statusText}</div>
                                <div class="text-xs text-gray-500 mt-1">è¿è¡Œæ—¶é—´: ${service.uptime}</div>
                            </div>
                        </div>
                    `;
                });
                
                serviceStatusContainer.innerHTML = servicesHtml;
                
            } catch (error) {
                console.error('åŠ è½½ç³»ç»ŸçŠ¶æ€å¤±è´¥:', error);
            }
        }

        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            const resultDiv = document.getElementById('connection-result');
            resultDiv.innerHTML = '<div class="flex items-center space-x-2"><div class="loading"></div><span>æµ‹è¯•ä¸­...</span></div>';
            
            try {
                const response = await fetch('http://localhost:8000/health');
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="flex items-center space-x-2 text-green-600">
                            <i data-lucide="check-circle" class="w-4 h-4"></i>
                            <span>è¿æ¥æˆåŠŸï¼APIæœåŠ¡å™¨è¿è¡Œæ­£å¸¸</span>
                        </div>
                    `;
                } else {
                    throw new Error('APIå“åº”å¼‚å¸¸');
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="flex items-center space-x-2 text-red-600">
                        <i data-lucide="x-circle" class="w-4 h-4"></i>
                        <span>è¿æ¥å¤±è´¥ï¼š${error.message}</span>
                    </div>
                `;
            }
            
            lucide.createIcons();
        }

        // å®šæœŸæ›´æ–°çŠ¶æ€
        setInterval(loadSystemStatus, 30000); // æ¯30ç§’æ›´æ–°ä¸€æ¬¡
    </script>
</body>
</html>